<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Brand Portal</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #121212; color: white; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .container { background: #1e1e1e; padding: 20px; border-radius: 15px; width: 95%; max-width: 400px; text-align: center; border: 1px solid #333; }
        
        /* LOGO STYLING - Replace URL with your brand logo link */
        .brand-logo { width: 150px; height: auto; margin-bottom: 20px; }

        input { width: 100%; padding: 12px; margin: 8px 0; border: 2px solid #333; border-radius: 8px; background: #2c2c2c; color: white; font-size: 16px; box-sizing: border-box; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .full { grid-column: span 2; }
        
        button { width: 100%; padding: 15px; margin: 5px 0; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; color: white; cursor: pointer; transition: 0.2s; }
        button:active { transform: scale(0.98); }

        /* Custom Button Colors */
        .btn-in { background: #2e7d32; }
        .btn-break { background: #f9a825; color: black; }
        .btn-store { background: #00838f; }
        .btn-leave { background: #673ab7; }
        .btn-out { background: #c62828; }
        
        /* Hidden state for locked buttons */
        .locked { display: none !important; }
        #status-msg { font-size: 14px; margin-top: 10px; color: #4caf50; }
    </style>
</head>
<body>

<div class="container">
    <img src="https://ximiso.com/template/static/images/logo.png" alt="Brand Logo" class="brand-logo">
    
    <input type="text" id="name" placeholder="Staff Name" required>
    <input type="number" id="sale" placeholder="Total Sale Amount" inputmode="numeric">
    <input type="number" id="bills" placeholder="Number of Bills" inputmode="numeric">

    <button id="btn_PUNCH_IN" class="btn-in full" onclick="submitData('PUNCH IN')">PUNCH IN</button>
    
    <div class="grid">
        <button class="btn-break" onclick="submitData('BREAK START')">BREAK START</button>
        <button class="btn-break" onclick="submitData('BREAK END')">BREAK END</button>
        
        <button id="btn_STORE_OPEN" class="btn-store" onclick="submitData('STORE OPEN')">STORE OPEN</button>
        <button id="btn_STORE_CLOSED" class="btn-store" onclick="submitData('STORE CLOSED')">STORE CLOSED</button>
    </div>

    <button id="btn_I_AM_ON_LEAVE" class="btn-leave full" onclick="submitData('I AM ON LEAVE')">I AM ON LEAVE</button>
    <button id="btn_PUNCH_OUT" class="btn-out full" onclick="submitData('PUNCH OUT & SEND SALES')">PUNCH OUT & SEND SALES</button>

    <div id="status-msg"></div>
</div>

<script>
    // 1. UPDATE WITH YOUR ACTUAL APPS SCRIPT URL
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzVnHMSIeKhE1Oc9y7dbK52V6MQaCfF6lLsx8B8lALwGTU4XAxl6bynio2ZyQNYtSWf/exec";

    // 2. Logic to hide one-time buttons if used today
    window.onload = function() {
        const today = new Date().toDateString();
        const oncePerDayButtons = ['btn_PUNCH_IN', 'btn_STORE_OPEN', 'btn_STORE_CLOSED', 'btn_I_AM_ON_LEAVE', 'btn_PUNCH_OUT'];
        
        oncePerDayButtons.forEach(id => {
            if (localStorage.getItem(id) === today) {
                const btn = document.getElementById(id);
                if (btn) btn.classList.add('locked');
            }
        });
    };

    function submitData(action) {
        const name = document.getElementById('name').value.trim();
        const sale = document.getElementById('sale').value || "0";
        const bills = document.getElementById('bills').value || "0";
        const msg = document.getElementById('status-msg');

        if (!name) return alert("Please enter your name!");

        // Disable UI to prevent double-tap
        const buttons = document.querySelectorAll('button');
        buttons.forEach(b => b.disabled = true);
        msg.innerText = "Sending " + action + "...";

        fetch(SCRIPT_URL, {
            method: "POST",
            mode: "no-cors",
            body: JSON.stringify({ name, action, sale, bills })
        })
        .then(() => {
            alert("âœ… " + action + " Successfully recorded!");
            
            // Map actions to their button IDs for locking
            const actionMapping = {
                "PUNCH IN": "btn_PUNCH_IN",
                "STORE OPEN": "btn_STORE_OPEN",
                "STORE CLOSED": "btn_STORE_CLOSED",
                "I AM ON LEAVE": "btn_I_AM_ON_LEAVE",
                "PUNCH OUT & SEND SALES": "btn_PUNCH_OUT"
            };

            // Only lock if it's in our one-time list (excludes breaks)
            if (actionMapping[action]) {
                localStorage.setItem(actionMapping[action], new Date().toDateString());
            }

            location.reload();
        })
        .catch(err => {
            alert("Error! Please check connection.");
            buttons.forEach(b => b.disabled = false);
            msg.innerText = "";
        });
    }
</script>
</body>
</html>
